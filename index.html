<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI æ¨¡æ“¬æœªä¾†ä¼´ä¾¶</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #ff758c; /* æˆ€æ„›ç²‰ */
            --secondary-color: #ff7eb3; /* æŸ”å’Œç²‰ */
            --tech-blue: #4facfe; /* ç§‘æŠ€è— */
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.6);
        }

        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
            display: flex;
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-y: auto; 
            overflow-x: hidden;
            padding: 20px 0;
        }

        .container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 2.5rem;
            border-radius: 25px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            border: 1px solid var(--glass-border);
            width: 90%;
            max-width: 420px;
            text-align: center;
            position: relative;
            z-index: 10;
            transition: transform 0.3s;
        }

        h2 {
            color: #444;
            margin-bottom: 25px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        h2 i {
            color: var(--primary-color);
            margin-right: 8px;
        }

        p { color: #666; line-height: 1.6; }

        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-love {
            background: linear-gradient(to right, #ff758c, #ff7eb3);
            color: white;
        }
        .btn-love:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 117, 140, 0.4);
        }
        
        .btn-tech {
            background: linear-gradient(to right, #4facfe, #00f2fe);
            color: white;
        }
        .btn-tech:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(79, 172, 254, 0.4);
        }

        .btn-danger {
            background: linear-gradient(to right, #ff9966, #ff5e62);
            color: white;
        }
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 94, 98, 0.4);
        }

        .btn:active {
            transform: scale(0.98);
        }

        input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            box-sizing: border-box;
            border: 2px solid #eee;
            border-radius: 12px;
            font-size: 16px;
            transition: 0.3s;
            background: rgba(255,255,255,0.9);
            color: #555;
        }
        input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(255, 117, 140, 0.2);
        }
        
        input[type="date"] {
            font-family: 'Microsoft JhengHei', sans-serif;
            color: #666;
        }

        .label-text {
            text-align: left;
            font-size: 14px;
            color: #888;
            margin-left: 5px;
            margin-top: 5px;
        }

        .hidden { display: none; }

        .result-img {
            width: 100%;
            height: auto;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 4px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: fadeIn 1s ease;
        }

        #curse-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            z-index: 999;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: red;
            font-family: 'Courier New', monospace;
        }

        .curse-text {
            font-size: 3rem;
            font-weight: bold;
            text-shadow: 2px 2px 0px #fff;
            animation: glitch 0.2s infinite;
        }

        .tech-text {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: var(--tech-blue);
            font-weight: bold;
        }

        .footer-watermark {
            margin-top: 20px; 
            width: 100%;
            text-align: center;
            color: rgba(100, 100, 100, 0.5); 
            font-size: 13px;
            font-weight: bold;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        @keyframes glitch {
            0% { transform: translate(0) }
            20% { transform: translate(-2px, 2px) }
            40% { transform: translate(-2px, -2px) }
            60% { transform: translate(2px, 2px) }
            80% { transform: translate(2px, -2px) }
            100% { transform: translate(0) }
        }

        .shake-body {
            animation: shake 0.5s;
            animation-iteration-count: infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body>

<div id="curse-overlay">
    <div class="curse-text">WARNING</div>
    <p style="color: white; font-size: 1.2rem; margin-top: 20px;">SYSTEM CORRUPTED...<br>èªªè¬Šçš„äººæœƒè¢«è©›å’’...</p>
    <i class="fas fa-skull-crossbones" style="font-size: 5rem; margin-top: 30px; color: red;"></i>
</div>

<div class="container">
    <div id="step1">
        <h2><i class="fas fa-microchip"></i> AI æ¨¡æ“¬æœªä¾†ä¼´ä¾¶</h2>
        <p>æ­¡è¿å•Ÿå‹•æƒ…æ„Ÿç¥ç¶“ç¶²çµ¡ç³»çµ±<br>åœ¨é€²è¡Œæ¨¡æ“¬å‰ï¼Œæˆ‘å€‘å¿…é ˆç¢ºèª...</p>
        <button class="btn btn-love" onclick="nextStep(1, true)">
            <i class="fas fa-check"></i> æ˜¯ï¼Œæˆ‘å–®èº«
        </button>
        <button class="btn btn-tech" onclick="honestUser()">
            <i class="fas fa-times"></i> å¦ï¼Œæˆ‘æœ‰å°è±¡
        </button>
    </div>

    <div id="step-honest" class="hidden">
        <h2><i class="fas fa-dove"></i> æ„Ÿè¬ä½ çš„èª å¯¦</h2>
        <p>èª å¯¦æ˜¯ç¶­ç¹«æ„Ÿæƒ…æœ€é‡è¦çš„åŸºçŸ³<br>ç¥ä½ å€‘å¹¸ç¦ç¾æ»¿ï¼Œé•·é•·ä¹…ä¹…ï¼ğŸ’–</p>
        <button class="btn btn-tech" onclick="shareResult()">
            <i class="fas fa-share-alt"></i> åˆ†äº«çµ¦ä½ å–®èº«çš„æœ‹å‹å§
        </button>
    </div>

    <div id="step2" class="hidden">
        <h2><i class="fas fa-exclamation-circle"></i> éˆé­‚æ‹·å•</h2>
        <p>ç¢ºå®šå–®èº«å—ï¼Ÿ<br>é€™æ˜¯ä¸€å ´å–®èº«è€…çš„ç‹‚æ­¡<br>æœ‰å°è±¡é‚„ç©...å¾Œæœè‡ªè²  ğŸ‘»</p>
        <button class="btn btn-love" onclick="nextStep(2, true)">
            <i class="fas fa-shield-alt"></i> æˆ‘ç™¼èª“ï¼ŒçœŸçš„å–®èº«ï¼
        </button>
        <button class="btn btn-danger" onclick="triggerCurse()">
            <i class="fas fa-running"></i> æˆ‘é‚„æ˜¯å…ˆæºœå¥½äº†...
        </button>
    </div>

    <div id="step3" class="hidden">
        <h2><i class="fas fa-user-astronaut"></i> è¼¸å…¥åƒæ•¸å•Ÿå‹•æ¨¡æ“¬</h2>
        
        <div class="label-text">å§“å</div>
        <input type="text" id="userName" placeholder="è«‹è¼¸å…¥ä¸­æ–‡å§“å">
        
        <div class="label-text">ç”Ÿæ—¥ (ç”¨æ–¼å‘½ç›¤æ ¡æº–)</div>
        <input type="date" id="userBirth">

        <div class="label-text">é›»è©± (é‚±æ¯”ç‰¹å¥½è¯ç¹«ä½ )</div>
        <input type="tel" id="userPhone" placeholder="ex: 0912345678" maxlength="10">
        
        <div style="margin: 15px 0; padding: 10px; border: 1px dashed #ccc; border-radius: 10px; color: #888; font-size: 0.9rem;">
            <i class="fas fa-camera"></i> ä¸Šå‚³ç…§ç‰‡ (é¢ç›¸åˆ†æåƒæ•¸-é¸å¡«)
            <input type="file" id="userPhoto" style="border:none; background:transparent;">
        </div>

        <button class="btn btn-love" onclick="startPrediction()">
            <i class="fas fa-magic"></i> é–‹å§‹ AI æ¨¡æ“¬
        </button>
    </div>

    <div id="loading" class="hidden">
        <h2 style="color: var(--tech-blue);">æ­£åœ¨åˆå§‹åŒ–ç¥ç¶“ç¶²çµ¡...</h2>
        <p class="tech-text" id="loadingMsg">è¼‰å…¥ç”Ÿç‰©ç‰¹å¾µæ•¸æ“š...</p>
        <img src="https://i.gifer.com/origin/b4/b4d657e7ef262b88eb5f7ac021edda87.gif" alt="loading" width="80" style="border-radius: 50%;">
    </div>

    <div id="result" class="hidden">
        <h2 style="color: var(--primary-color);">æ¨¡æ“¬çµæœå®Œæˆ</h2>
        <img id="futureWifeImg" src="" class="result-img">
        <p id="resultName" style="font-weight: bold; font-size: 1.1rem;"></p>
        
        <button class="btn btn-tech" onclick="shareResult()">
            <i class="fas fa-share-alt"></i> åˆ†äº«çµ¦æœ‹å‹çœ‹
        </button>
        <button class="btn btn-love" onclick="wantToDate()">
            <i class="fas fa-heart"></i> çœŸçš„å¥½æƒ³è„«å–®
        </button>
    </div>
</div>

<div class="footer-watermark">[ä¾›äº¤å‹å¹³å°ä½¿ç”¨]</div>

<script>
    // âš ï¸ã€è«‹å°‡é€™è£¡æ›æˆä½  Google Apps Script çš„ç¶²å€ã€‘âš ï¸
    const scriptURL = "https://script.google.com/macros/s/AKfycby7A67cffg8adasBWZo0eeO61DHmF3CHHchedP6mPIf4vFXU-ryQDq-_tAyEM6ZdMiYhw/exec";

    let currentUser = { name: "", phone: "", birth: "" };

    function nextStep(currentStep, isYes) {
        if (isYes) {
            document.getElementById(`step${currentStep}`).classList.add('hidden');
            document.getElementById(`step${currentStep + 1}`).classList.remove('hidden');
        }
    }

    function honestUser() {
        document.getElementById('step1').classList.add('hidden');
        document.getElementById('step-honest').classList.remove('hidden');
    }

    function triggerCurse() {
        const overlay = document.getElementById('curse-overlay');
        overlay.style.display = 'flex';
        document.body.classList.add('shake-body');
        setTimeout(() => {
            alert("ç³»çµ±åµæ¸¬åˆ°ç•°å¸¸...å¼·åˆ¶çµ‚æ­¢é€£ç·šï¼");
            location.reload();
        }, 2500);
    }

    function startPrediction() {
        const nameInput = document.getElementById('userName').value.trim();
        const phoneInput = document.getElementById('userPhone').value.trim();
        const birthInput = document.getElementById('userBirth').value;

        const chineseNamePattern = /^[\u4e00-\u9fa5]+$/;
        if (!nameInput) { alert("è«‹è¼¸å…¥å§“åï¼"); return; }
        if (!chineseNamePattern.test(nameInput)) { alert("å§“åæ ¼å¼éŒ¯èª¤ï¼šå¿…é ˆå…¨éƒ¨ç‚ºã€Œä¸­æ–‡ã€ï¼"); return; }

        if (!birthInput) { alert("è«‹é¸æ“‡å‡ºç”Ÿå¹´æœˆæ—¥ï¼"); return; }

        const phonePattern = /^09\d{8}$/;
        if (!phoneInput) { alert("è«‹è¼¸å…¥é›»è©±ï¼"); return; }
        if (!phonePattern.test(phoneInput)) { alert("é›»è©±æ ¼å¼éŒ¯èª¤ï¼šå¿…é ˆæ˜¯ã€Œ09ã€é–‹é ­çš„ 10 ä½æ•¸å­—ï¼"); return; }

        currentUser.name = nameInput;
        currentUser.phone = phoneInput;
        currentUser.birth = birthInput;

        document.getElementById('step3').classList.add('hidden');
        document.getElementById('loading').classList.remove('hidden');
        const msg = document.getElementById('loadingMsg');
        
        // â˜… å‡ç´šç‰ˆï¼šæ›´é•·çš„é‹ç®—éç¨‹ â˜…
        msg.innerText = "è¼‰å…¥ Deep Learning æ¨¡å‹...";
        
        setTimeout(() => { msg.innerText = "è§£æä½¿ç”¨è€…ç”Ÿç‰©ç‰¹å¾µ..."; }, 800);
        setTimeout(() => { msg.innerText = "æª¢ç´¢å…¨çƒäººè‡‰æ•¸æ“šåº«..."; }, 1600); // æ–°å¢
        setTimeout(() => { msg.innerText = "é‡å­ç³¾çºå‘½é‹æ¼”ç®—ä¸­..."; }, 2400); // æ–°å¢
        setTimeout(() => { msg.innerText = "æ’é™¤éç·šæ€§æƒ…æ„Ÿé›œè¨Š..."; }, 3200); // æ–°å¢
        setTimeout(() => { msg.innerText = "æ­£åœ¨é€²è¡Œ GAN å½±åƒç”Ÿæˆ..."; }, 4000);
        setTimeout(() => { msg.innerText = "æœ€çµ‚é…å°æŒ‡æ•¸æ”¶æ–‚ä¸­..."; }, 4800);

        const requestUrl = `${scriptURL}?type=predict&name=${encodeURIComponent(nameInput)}&phone=${encodeURIComponent(phoneInput)}&birth=${encodeURIComponent(birthInput)}`;

        fetch(requestUrl)
            .then(response => response.json())
            .then(data => {
                if(data.status === "error") {
                    alert("é‹ç®—éŒ¯èª¤ï¼š" + data.message);
                    location.reload();
                    return;
                }
                // â˜… é€™è£¡å»¶é•·åˆ° 5500msï¼Œç¢ºä¿ä¸Šé¢é‚£äº›å¸¥æ°£çš„å­—éƒ½æœ‰è·‘å®Œ â˜…
                setTimeout(() => { showResult(nameInput, data.imageUrl); }, 5500); 
            })
            .catch(error => {
                console.error('Error:', error);
                alert("é€£ç·šç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²å€æˆ–ç¨å¾Œå†è©¦ï¼");
                location.reload();
            });
    }

    function showResult(name, imageUrl) {
        document.getElementById('loading').classList.add('hidden');
        document.getElementById('result').classList.remove('hidden');

        const img = document.getElementById('futureWifeImg');
        img.src = imageUrl;
        document.getElementById('resultName').innerHTML = `é‹ç®—å®Œæˆï¼š${name} çš„ AI æ¨¡æ“¬å°è±¡`;
    }

    function shareResult() {
        if (navigator.share) {
            navigator.share({
                title: 'AI æ¨¡æ“¬æœªä¾†ä¼´ä¾¶',
                text: 'é€™æ˜¯ä¸€å€‹è¶…æº–çš„ AI æœªä¾†ä¼´ä¾¶æ¨¡æ“¬ï¼Œå–®èº«çš„æœ‹å‹å¿«ä¾†æ¸¬ï¼',
                url: window.location.href,
            });
        } else {
            alert("é€£çµå·²è¤‡è£½ï¼å¿«å»å‚³çµ¦æœ‹å‹çœ‹ï¼");
        }
    }

    function wantToDate() {
        const btn = event.target;
        btn.innerText = "æ­£åœ¨åŠ å¯†å‚³è¼¸...";
        const requestUrl = `${scriptURL}?type=date&name=${encodeURIComponent(currentUser.name)}&phone=${encodeURIComponent(currentUser.phone)}&birth=${encodeURIComponent(currentUser.birth)}`;
        
        fetch(requestUrl)
            .then(response => response.json())
            .then(data => {
                alert("æ”¶åˆ°ï¼å·²å°‡ä½ çš„æ„é¡˜å¯«å…¥è³‡æ–™åº«ï¼Œè«‹éœå€™ä½³éŸ³ ğŸ…");
                btn.innerText = "å·²é ç´„è–èª•ç§˜æ›¸";
                btn.disabled = true;
                btn.style.background = "#ccc";
                btn.style.transform = "none";
                btn.style.boxShadow = "none";
            });
    }
</script>

</body>
</html>
